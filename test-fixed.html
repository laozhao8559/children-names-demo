<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å„¿ç«¥è¯†å­—å°æŠ¥ç”Ÿæˆå™¨ - ä¿®å¤ç‰ˆæœ¬</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸ¨ å„¿ç«¥è¯†å­—å°æŠ¥ç”Ÿæˆå™¨ (ä¿®å¤ç‰ˆæœ¬)</h1>
            <p>æµ‹è¯•ç‰©å“æ˜¾ç¤ºå’Œè¯­è¨€æ ‡ç­¾ä¿®å¤</p>
        </header>

        <!-- è°ƒè¯•ä¿¡æ¯ -->
        <div id="debugInfo" style="background: #e3f2fd; padding: 15px; margin: 15px 0; border-radius: 8px; border-left: 4px solid #2196F3;">
            <h4>ğŸ” è°ƒè¯•å’Œæµ‹è¯•ä¿¡æ¯:</h4>
            <div id="debugContent">ç­‰å¾…æ“ä½œ...</div>
        </div>

        <main class="main-content">
            <!-- å¿«é€Ÿæµ‹è¯•è¡¨å• -->
            <div class="step-content active">
                <h2>âš¡ å¿«é€Ÿæµ‹è¯•è¡¨å•</h2>
                <form id="quickTestForm">
                    <div class="form-group">
                        <label>é€‰æ‹©ä¸»é¢˜:</label>
                        <select id="theme" name="theme" required>
                            <option value="">è¯·é€‰æ‹©...</option>
                            <option value="è¶…å¸‚">è¶…å¸‚</option>
                            <option value="åŒ»é™¢">åŒ»é™¢</option>
                            <option value="å…¬å›­">å…¬å›­</option>
                            <option value="å­¦æ ¡">å­¦æ ¡</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>æ ‡é¢˜:</label>
                        <input type="text" id="title" name="title" value="æµ‹è¯•å°æŠ¥" required>
                    </div>

                    <div class="form-group">
                        <label>è¯­è¨€ç»„åˆ:</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="chinese" checked>
                                <span>ä¸­æ–‡</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="english" checked>
                                <span>è‹±æ–‡</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="pinyin">
                                <span>æ‹¼éŸ³</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>éš¾åº¦ç­‰çº§:</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="difficulty" value="level1" checked>
                                <span>Level 1 (5-6å²)</span>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="difficulty" value="level2">
                                <span>Level 2 (6-8å²)</span>
                            </label>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">ç”Ÿæˆæµ‹è¯•æ•°æ®</button>
                </form>
            </div>

            <!-- æ˜¾ç¤ºç»“æœ -->
            <div id="results" style="display: none;">
                <h2>ğŸ“Š ç”Ÿæˆç»“æœ</h2>

                <div class="result-section">
                    <h3>1. ç”Ÿæˆçš„è¯æ±‡è¡¨</h3>
                    <div id="vocabularyResult"></div>
                </div>

                <div class="result-section">
                    <h3>2. è¯­è¨€æ ‡ç­¾ç»„åˆ</h3>
                    <div id="tagsResult"></div>
                </div>

                <div class="result-section">
                    <h3>3. æœ€ç»ˆç»˜å›¾Prompt</h3>
                    <div id="promptResult" style="background: #f8f9fa; padding: 15px; border-radius: 8px; white-space: pre-wrap; font-family: monospace; font-size: 14px; max-height: 400px; overflow-y: auto;"></div>
                </div>

                <div class="result-section">
                    <h3>4. å¤åˆ¶Prompt</h3>
                    <button class="btn btn-primary" onclick="copyPrompt()">å¤åˆ¶Promptåˆ°å‰ªè´´æ¿</button>
                    <span id="copyStatus" style="margin-left: 10px; color: #4CAF50;"></span>
                </div>
            </div>
        </main>
    </div>

    <script src="vocabulary.js"></script>
    <script>
        let userData = {};
        let vocabulary = [];
        let tags = [];
        let finalPrompt = '';

        function log(message) {
            const debugContent = document.getElementById('debugContent');
            const timestamp = new Date().toLocaleTimeString();
            debugContent.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            console.log(message);
        }

        function showResults() {
            document.getElementById('results').style.display = 'block';
        }

        function displayVocabulary() {
            const container = document.getElementById('vocabularyResult');
            let html = `<table class="vocabulary-table" style="width: 100%;">
                <thead>
                    <tr>
                        <th>åºå·</th>
                        <th>ä¸­æ–‡</th>
                        <th>æ‹¼éŸ³</th>
                        <th>è‹±æ–‡</th>
                        <th>æ—¥æ–‡</th>
                    </tr>
                </thead>
                <tbody>`;

            vocabulary.forEach((word, index) => {
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td><strong>${word.chinese}</strong></td>
                        <td>${word.pinyin}</td>
                        <td>${word.english}</td>
                        <td>${word.japanese}</td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function displayTags() {
            const container = document.getElementById('tagsResult');
            let html = '<div class="tag-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">';

            tags.forEach((tag, index) => {
                html += `
                    <div style="background: #e8f5e8; padding: 10px; border-radius: 6px; border-left: 3px solid #4CAF50;">
                        <strong>${index + 1}.</strong> ${tag}
                    </div>
                `;
            });

            html += '</div>';
            container.innerHTML = html;
        }

        function createImagePrompt() {
            const environmentText = userData.environment ? `ï¼Œ${userData.environment}ç¯å¢ƒ` : '';
            const vocabularyItems = vocabulary.map(v => v.chinese).join('ã€');
            const ageGroup = userData.difficulty === 'level1' ? '5-6å²' : userData.difficulty === 'level2' ? '6-8å²' : '8-9å²';
            const sampleTagText = tags.slice(0, 3).join('ï¼Œ');

            const prompt = `å„¿ç«¥è¯†å­—æ•™è‚²æµ·æŠ¥ï¼Œæ ‡é¢˜"ã€Š${userData.title}}"ï¼Œ${userData.theme}ä¸»é¢˜åœºæ™¯${environmentText}ï¼Œé€‚åˆ${ageGroup}å„¿ç«¥å­¦ä¹ è¯†å­—ã€‚

ä¸»è¦å†…å®¹ï¼šåœ¨${userData.theme}åœºæ™¯ä¸­ï¼Œå¿…é¡»æ¸…æ™°ç»˜åˆ¶ä»¥ä¸‹ç‰©å“ï¼š${vocabularyItems}ã€‚æ¯ä¸ªç‰©å“æ—è¾¹éƒ½è¦æœ‰æ–‡å­—æ ‡ç­¾ï¼Œæ ‡ç­¾æ ¼å¼å¦‚ï¼š${sampleTagText}ã€‚

åœºæ™¯è¦æ±‚ï¼š
- åœºæ™¯åŒ…å«ï¼š${getCharactersByTheme()}
- èƒŒæ™¯è¦æœ‰${userData.theme}çš„å…¸å‹ç‰¹å¾ï¼Œä½†ä¸è¦è¿‡äºå¤æ‚
- æ•´ä½“å¸ƒå±€è¦åƒå„¿ç«¥æ•™è‚²æµ·æŠ¥ï¼Œæ¸…æ™°æ˜“è¯»

è§†è§‰é£æ ¼ï¼š
- A4ç«–ç‰ˆæ¯”ä¾‹ï¼Œå„¿ç«¥æ’ç”»é£æ ¼
- çº¿æ¡æ¸…æ™°ï¼Œè‰²å½©é²œè‰³æ˜äº®
- ç®€æ´å¹²å‡€çš„èƒŒæ™¯ï¼Œçªå‡ºæ•™å­¦ç‰©å“
- æ¯ä¸ªç‰©å“éƒ½è¦æœ‰è¶³å¤Ÿçš„ç•™ç™½ç©ºé—´æ”¾ç½®æ–‡å­—æ ‡ç­¾
- ç‰©å“å¤§å°é€‚ä¸­ï¼Œä¾¿äºå„¿ç«¥è¯†åˆ«

æ–‡å­—æ ‡ç­¾è¦æ±‚ï¼š
- æ ‡ç­¾è¦æ”¾åœ¨å¯¹åº”ç‰©å“é™„è¿‘ï¼Œç”¨ç»†çº¿è¿æ¥
- å­—ä½“è¦å¤§è€Œæ¸…æ™°ï¼Œé€‚åˆå„¿ç«¥é˜…è¯»
- æ ‡ç­¾ä¸è¦é‡å ï¼Œåˆ†å¸ƒå‡åŒ€
- é‡ç‚¹çªå‡ºç‰©å“çš„ä¸­æ–‡åç§°

æŠ€æœ¯è¦æ±‚ï¼š8Kåˆ†è¾¨ç‡ï¼Œé«˜è´¨é‡ç»†èŠ‚ï¼Œä¸“ä¸šå„¿ç«¥æ’ç”»é£æ ¼ï¼Œæ•™è‚²ç”¨é€”å‹å¥½ï¼Œè‰²å½©é¥±å’Œåº¦é€‚ä¸­ã€‚`;

            return prompt;
        }

        function getCharactersByTheme() {
            const characterMap = {
                'è¶…å¸‚': 'æ”¶é“¶å‘˜ã€è´­ç‰©çš„å°æœ‹å‹ã€åº—å‘˜ã€æ¨è´­ç‰©è½¦çš„å®¶åº­',
                'åŒ»é™¢': 'åŒ»ç”Ÿã€æŠ¤å£«ã€å°ç—…äººã€é™ªä¼´çš„å®¶é•¿',
                'å…¬å›­': 'ç©è€çš„å°æœ‹å‹ã€æ•£æ­¥çš„è€äººã€é”»ç‚¼çš„æˆå¹´äºº',
                'å­¦æ ¡': 'è€å¸ˆã€å­¦ç”Ÿã€æ ¡é•¿ã€å€¼ç­è€å¸ˆ'
            };

            return characterMap[userData.theme] || 'å°æœ‹å‹ã€è€å¸ˆã€å®¶é•¿';
        }

        function displayPrompt() {
            document.getElementById('promptResult').textContent = finalPrompt;
        }

        function copyPrompt() {
            navigator.clipboard.writeText(finalPrompt).then(() => {
                document.getElementById('copyStatus').textContent = 'âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿';
                setTimeout(() => {
                    document.getElementById('copyStatus').textContent = '';
                }, 3000);
            });
        }

        // è¡¨å•æäº¤å¤„ç†
        document.getElementById('quickTestForm').addEventListener('submit', function(e) {
            e.preventDefault();

            log('å¼€å§‹ç”Ÿæˆæµ‹è¯•æ•°æ®...');

            // æ”¶é›†æ•°æ®
            const formData = new FormData(e.target);
            userData = {
                theme: formData.get('theme'),
                title: formData.get('title'),
                languages: formData.getAll('languages'),
                difficulty: formData.get('difficulty'),
                environment: '' // ç®€åŒ–æµ‹è¯•ï¼Œä¸ä½¿ç”¨ç¯å¢ƒ
            };

            log('ç”¨æˆ·æ•°æ®: ' + JSON.stringify(userData, null, 2));

            // ç”Ÿæˆè¯æ±‡
            vocabulary = getVocabulary(userData.theme, userData.difficulty);
            log(`ç”Ÿæˆ ${vocabulary.length} ä¸ªè¯æ±‡`);

            // ç”Ÿæˆæ ‡ç­¾
            tags = generateTagText(vocabulary, userData.languages);
            log(`ç”Ÿæˆ ${tags.length} ä¸ªæ ‡ç­¾`);

            // ç”ŸæˆPrompt
            finalPrompt = createImagePrompt();
            log('ç”Ÿæˆæœ€ç»ˆPrompt');

            // æ˜¾ç¤ºç»“æœ
            displayVocabulary();
            displayTags();
            displayPrompt();
            showResults();

            log('æµ‹è¯•å®Œæˆï¼è¯·æ£€æŸ¥ç»“æœã€‚');
        });
    </script>
</body>
</html>