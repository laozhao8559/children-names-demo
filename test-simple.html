<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€åŒ–æµ‹è¯•ç‰ˆæœ¬</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸ§ª ç®€åŒ–æµ‹è¯•ç‰ˆæœ¬</h1>
            <p>æµ‹è¯•åŸºæœ¬çš„è¡¨å•æäº¤å’Œé¡µé¢è·³è½¬åŠŸèƒ½</p>
        </header>

        <main class="main-content">
            <!-- æ­¥éª¤1: è¡¨å• -->
            <div id="step1" class="step-content active">
                <h2>ğŸ“‹ æµ‹è¯•è¡¨å•</h2>
                <form id="testForm">
                    <div class="form-group">
                        <label for="theme">é€‰æ‹©ä¸»é¢˜:</label>
                        <select id="theme" name="theme" required>
                            <option value="">è¯·é€‰æ‹©ä¸»é¢˜...</option>
                            <option value="å…¬äº¤ç«™">å…¬äº¤ç«™</option>
                            <option value="åšç‰©é¦†">åšç‰©é¦†</option>
                            <option value="è¶…å¸‚">è¶…å¸‚</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="title">æ ‡é¢˜:</label>
                        <input type="text" id="title" name="title" placeholder="è¾“å…¥æ ‡é¢˜..." required>
                    </div>

                    <div class="form-group">
                        <label>é€‰æ‹©è¯­è¨€:</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="chinese" checked>
                                <span>ä¸­æ–‡</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="english">
                                <span>è‹±æ–‡</span>
                            </label>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary">æäº¤å¹¶è·³è½¬</button>
                </form>
            </div>

            <!-- æ­¥éª¤2: ç»“æœ -->
            <div id="step2" class="step-content">
                <h2>ğŸ“š ç»“æœæ˜¾ç¤º</h2>
                <div id="resultContainer">
                    <p>ç­‰å¾…ç»“æœ...</p>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="goToStep(1)">è¿”å›æ­¥éª¤1</button>
                </div>
            </div>
        </main>

        <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
        <div class="steps-indicator">
            <div class="step active" data-step="1">
                <span class="step-number">1</span>
                <span class="step-title">è¡¨å•</span>
            </div>
            <div class="step" data-step="2">
                <span class="step-number">2</span>
                <span class="step-title">ç»“æœ</span>
            </div>
        </div>
    </div>

    <script src="vocabulary.js"></script>
    <script>
        // å…¨å±€å˜é‡
        let userData = {};
        let vocabulary = [];

        // é¡µé¢åŠ è½½å®Œæˆ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== DOMåŠ è½½å®Œæˆ ===');
            initializeApp();
        });

        function initializeApp() {
            console.log('=== åˆå§‹åŒ–åº”ç”¨ ===');

            const form = document.getElementById('testForm');
            if (form) {
                console.log('æ‰¾åˆ°è¡¨å•ï¼Œç»‘å®šæäº¤äº‹ä»¶');
                form.addEventListener('submit', handleFormSubmit);
            } else {
                console.error('æœªæ‰¾åˆ°è¡¨å•å…ƒç´ ï¼');
            }
        }

        // å¤„ç†è¡¨å•æäº¤
        function handleFormSubmit(e) {
            console.log('=== è¡¨å•æäº¤å¼€å§‹ ===');
            e.preventDefault();

            // æ”¶é›†è¡¨å•æ•°æ®
            const formData = new FormData(e.target);
            userData = {
                theme: formData.get('theme'),
                title: formData.get('title'),
                languages: formData.getAll('languages'),
                difficulty: 'level1'
            };

            console.log('æ”¶é›†åˆ°çš„æ•°æ®:', userData);

            // éªŒè¯æ•°æ®
            if (!userData.theme || !userData.title || !userData.languages.length) {
                alert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µï¼');
                return;
            }

            console.log('éªŒè¯é€šè¿‡ï¼Œå¼€å§‹å¤„ç†...');

            // ç”Ÿæˆè¯æ±‡
            try {
                vocabulary = getVocabulary(userData.theme, userData.difficulty);
                console.log('ç”Ÿæˆè¯æ±‡æˆåŠŸ:', vocabulary.length);

                // æ˜¾ç¤ºç»“æœ
                displayResults();

                // è·³è½¬åˆ°æ­¥éª¤2
                console.log('å‡†å¤‡è·³è½¬åˆ°æ­¥éª¤2...');
                goToStep(2);
                console.log('è·³è½¬å®Œæˆ');

            } catch (error) {
                console.error('å¤„ç†å‡ºé”™:', error);
                alert('å¤„ç†å‡ºé”™: ' + error.message);
            }
        }

        // æ˜¾ç¤ºç»“æœ
        function displayResults() {
            const container = document.getElementById('resultContainer');

            let html = `
                <div class="result-section">
                    <h3>æäº¤çš„ä¿¡æ¯</h3>
                    <p><strong>ä¸»é¢˜:</strong> ${userData.theme}</p>
                    <p><strong>æ ‡é¢˜:</strong> ${userData.title}</p>
                    <p><strong>è¯­è¨€:</strong> ${userData.languages.join(', ')}</p>
                </div>

                <div class="result-section">
                    <h3>ç”Ÿæˆçš„è¯æ±‡ (${vocabulary.length}ä¸ª)</h3>
                    <div class="vocabulary-grid">
            `;

            vocabulary.slice(0, 8).forEach((item, index) => {
                html += `
                    <div class="vocabulary-item">
                        <strong>${index + 1}. ${item.chinese}</strong><br>
                        <small>${item.english}</small>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;

            container.innerHTML = html;
        }

        // è·³è½¬åˆ°æŒ‡å®šæ­¥éª¤
        function goToStep(step) {
            console.log(`è·³è½¬åˆ°æ­¥éª¤ ${step}`);

            // éšè—æ‰€æœ‰æ­¥éª¤
            document.querySelectorAll('.step-content').forEach(el => {
                el.classList.remove('active');
            });

            // æ˜¾ç¤ºç›®æ ‡æ­¥éª¤
            const targetStep = document.getElementById(`step${step}`);
            if (targetStep) {
                targetStep.classList.add('active');
                console.log(`æˆåŠŸæ˜¾ç¤ºæ­¥éª¤ ${step}`);
            } else {
                console.error(`æœªæ‰¾åˆ°æ­¥éª¤ ${step}`);
            }

            // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
            document.querySelectorAll('.step').forEach(el => {
                el.classList.remove('active', 'completed');
            });

            for (let i = 1; i <= step; i++) {
                const indicator = document.querySelector(`.step[data-step="${i}"]`);
                if (indicator) {
                    if (i < step) {
                        indicator.classList.add('completed');
                    } else {
                        indicator.classList.add('active');
                    }
                }
            }
        }

        console.log('è„šæœ¬åŠ è½½å®Œæˆ');
    </script>
</body>
</html>