<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å„¿ç«¥è¯†å­—å°æŠ¥ç”Ÿæˆå™¨ - è°ƒè¯•ç‰ˆæœ¬</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸ¨ å„¿ç«¥è¯†å­—å°æŠ¥ç”Ÿæˆå™¨ (è°ƒè¯•ç‰ˆæœ¬)</h1>
            <p>æ ¹æ®ä¸»é¢˜/åœºæ™¯è‡ªåŠ¨ç”Ÿæˆå„¿ç«¥è¯†å­—å°æŠ¥ç»˜å›¾Prompt</p>
        </header>

        <!-- è°ƒè¯•ä¿¡æ¯ -->
        <div id="debugInfo" style="background: yellow; padding: 10px; margin: 10px 0; border-radius: 5px;">
            <h4>è°ƒè¯•ä¿¡æ¯:</h4>
            <div id="debugContent">ç­‰å¾…ç”¨æˆ·æ“ä½œ...</div>
        </div>

        <!-- ä¸»è¦å†…å®¹åŒº -->
        <main class="main-content">
            <!-- æ­¥éª¤1: 5ä¸ªé—®é¢˜ -->
            <div id="step1" class="step-content active">
                <h2>ğŸ“‹ è¯·å›ç­”ä»¥ä¸‹5ä¸ªé—®é¢˜</h2>
                <form id="questionsForm">
                    <div class="form-group">
                        <label for="theme">1. æœ¬æœŸå„¿ç«¥è¯†å­—å°æŠ¥çš„ä¸»é¢˜/åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</label>
                        <select id="theme" name="theme" required>
                            <option value="">è¯·é€‰æ‹©ä¸»é¢˜...</option>
                            <option value="è¶…å¸‚">è¶…å¸‚</option>
                            <option value="å…¬å›­">å…¬å›­</option>
                            <option value="åŒ»é™¢">åŒ»é™¢</option>
                            <option value="å­¦æ ¡">å­¦æ ¡</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="title">2. å°æŠ¥çš„å¤§æ ‡é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ</label>
                        <input type="text" id="title" name="title" placeholder="å¦‚ï¼šã€Šèµ°è¿›è¶…å¸‚ã€‹" required>
                    </div>

                    <div class="form-group">
                        <label>3. ä½ å¸Œæœ›æ ‡ç­¾æ˜¾ç¤ºå“ªäº›è¯­è¨€ï¼Ÿï¼ˆå¯ä»»æ„ç»„åˆï¼‰</label>
                        <div class="checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="chinese" checked>
                                <span>ä¸­æ–‡</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="pinyin">
                                <span>æ‹¼éŸ³</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="languages" value="english">
                                <span>è‹±æ–‡</span>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="difficulty">4. ä½ å¸Œæœ›æœ¬æœŸè¯æ±‡éš¾åº¦ç­‰çº§æ˜¯ï¼Ÿ</label>
                        <div class="radio-group">
                            <label class="radio-label">
                                <input type="radio" name="difficulty" value="level1" checked>
                                <div class="radio-content">
                                    <strong>Level 1ï¼š</strong>æ—¥å¸¸å¸¸è§ï¼ˆé€‚åˆ 5â€“6 å²ï¼‰
                                </div>
                            </label>
                            <label class="radio-label">
                                <input type="radio" name="difficulty" value="level2">
                                <div class="radio-content">
                                    <strong>Level 2ï¼š</strong>åœºæ™¯å®Œæ•´è¯æ±‡ï¼ˆé€‚åˆ 6â€“8 å²ï¼‰
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="environment">5. ç”»é¢éœ€è¦ä½“ç°å­£èŠ‚ã€å¤©æ°”æˆ–åœ°ç†ç‰¹å¾å—ï¼Ÿ</label>
                        <select id="environment" name="environment">
                            <option value="">æ— ç‰¹åˆ«è¦æ±‚</option>
                            <option value="æ˜¥å­£">æ˜¥å­£</option>
                            <option value="æ™´å¤©">æ™´å¤©</option>
                            <option value="æ£®æ—">æ£®æ—</option>
                        </select>
                    </div>

                    <button type="submit" class="btn btn-primary">ä¸‹ä¸€æ­¥ï¼šç”Ÿæˆè¯æ±‡</button>
                </form>
            </div>

            <!-- æ­¥éª¤2: æ˜¾ç¤ºç”Ÿæˆçš„è¯æ±‡ -->
            <div id="step2" class="step-content">
                <h2>ğŸ“š è‡ªåŠ¨ç”Ÿæˆçš„è¯æ±‡åº“</h2>
                <div id="vocabularyList" class="vocabulary-list">
                    <p>æ­£åœ¨ç”Ÿæˆè¯æ±‡...</p>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">ä¸Šä¸€æ­¥</button>
                    <button class="btn btn-primary" onclick="testStep3()">æµ‹è¯•ï¼šè·³è½¬åˆ°æ­¥éª¤3</button>
                </div>
            </div>

            <!-- æ­¥éª¤3: æµ‹è¯•æ­¥éª¤ -->
            <div id="step3" class="step-content">
                <h2>ğŸ·ï¸ æ ‡ç­¾ç»„åˆç»“æœ</h2>
                <div id="tagList" class="tag-list">
                    <p>è¿™æ˜¯æ­¥éª¤3çš„æµ‹è¯•å†…å®¹</p>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousStep()">ä¸Šä¸€æ­¥</button>
                    <button class="btn btn-primary" onclick="goToStep(1)">è¿”å›æ­¥éª¤1</button>
                </div>
            </div>
        </main>

        <!-- åŠ è½½æç¤º -->
        <div id="loadingOverlay" class="loading-overlay hidden">
            <div class="loading-spinner"></div>
            <p id="loadingText">å¤„ç†ä¸­...</p>
        </div>
    </div>

    <script>
        // ç®€åŒ–çš„æµ‹è¯•è„šæœ¬
        let currentStep = 1;
        let userData = {};
        let vocabulary = [];

        function debugLog(message) {
            const debugContent = document.getElementById('debugContent');
            const timestamp = new Date().toLocaleTimeString();
            debugContent.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            console.log(message);
        }

        function initializeApp() {
            debugLog('åˆå§‹åŒ–åº”ç”¨...');

            // æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨
            const form = document.getElementById('questionsForm');
            if (form) {
                debugLog('æ‰¾åˆ°è¡¨å•å…ƒç´ ï¼Œç»‘å®šäº‹ä»¶...');
                form.addEventListener('submit', handleFormSubmit);
            } else {
                debugLog('é”™è¯¯ï¼šæœªæ‰¾åˆ°è¡¨å•å…ƒç´ ï¼');
            }
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            debugLog('è¡¨å•æäº¤äº‹ä»¶è§¦å‘ï¼');

            try {
                // æ”¶é›†ç”¨æˆ·æ•°æ®
                const formData = new FormData(e.target);
                userData = {
                    theme: formData.get('theme'),
                    title: formData.get('title'),
                    languages: formData.getAll('languages'),
                    difficulty: formData.get('difficulty'),
                    environment: formData.get('environment')
                };

                debugLog('æ”¶é›†åˆ°çš„æ•°æ®: ' + JSON.stringify(userData, null, 2));

                // éªŒè¯å¿…å¡«å­—æ®µ
                if (!userData.theme || !userData.title || !userData.languages.length || !userData.difficulty) {
                    debugLog('éªŒè¯å¤±è´¥ï¼šç¼ºå°‘å¿…å¡«å­—æ®µ');
                    alert('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µï¼');
                    return;
                }

                debugLog('éªŒè¯é€šè¿‡ï¼Œå¼€å§‹ç”Ÿæˆè¯æ±‡...');
                generateVocabulary();
            } catch (error) {
                debugLog('å¤„ç†è¡¨å•æ—¶å‡ºé”™: ' + error.message);
                alert('å¤„ç†è¡¨å•æ—¶å‡ºé”™ï¼š' + error.message);
            }
        }

        function generateVocabulary() {
            debugLog('å¼€å§‹ç”Ÿæˆè¯æ±‡...');
            showLoading('æ­£åœ¨ç”Ÿæˆè¯æ±‡åº“...');

            // æ¨¡æ‹Ÿè¯æ±‡ç”Ÿæˆ
            setTimeout(() => {
                try {
                    // ç®€åŒ–çš„è¯æ±‡æ•°æ®ç”¨äºæµ‹è¯•
                    vocabulary = [
                        {chinese: 'è‹¹æœ', pinyin: 'pÃ­ng guÇ’', english: 'apple', japanese: 'ã‚Šã‚“ã”'},
                        {chinese: 'é¦™è•‰', pinyin: 'xiÄng jiÄo', english: 'banana', japanese: 'ãƒãƒŠãƒŠ'},
                        {chinese: 'æ©™å­', pinyin: 'chÃ©ng zi', english: 'orange', japanese: 'ã‚ªãƒ¬ãƒ³ã‚¸'}
                    ];

                    debugLog('ç”Ÿæˆçš„æµ‹è¯•è¯æ±‡: ' + JSON.stringify(vocabulary, null, 2));
                    displayVocabulary();
                    hideLoading();

                    debugLog('å‡†å¤‡è·³è½¬åˆ°æ­¥éª¤2...');
                    goToStep(2);
                } catch (error) {
                    debugLog('ç”Ÿæˆè¯æ±‡æ—¶å‡ºé”™: ' + error.message);
                    hideLoading();
                    alert('ç”Ÿæˆè¯æ±‡æ—¶å‡ºé”™ï¼š' + error.message);
                }
            }, 1000);
        }

        function displayVocabulary() {
            debugLog('æ˜¾ç¤ºè¯æ±‡...');
            const container = document.getElementById('vocabularyList');

            let html = '<div class="vocabulary-grid"><table class="vocabulary-table">';
            html += '<thead><tr><th>åºå·</th><th>ä¸­æ–‡</th><th>æ‹¼éŸ³</th><th>è‹±æ–‡</th><th>æ—¥æ–‡</th></tr></thead><tbody>';

            vocabulary.forEach((word, index) => {
                html += `<tr><td>${index + 1}</td><td>${word.chinese}</td><td>${word.pinyin}</td><td>${word.english}</td><td>${word.japanese}</td></tr>`;
            });

            html += '</tbody></table></div>';
            container.innerHTML = html;
            debugLog('è¯æ±‡æ˜¾ç¤ºå®Œæˆ');
        }

        function goToStep(step) {
            debugLog('è·³è½¬åˆ°æ­¥éª¤ ' + step);

            // éšè—æ‰€æœ‰æ­¥éª¤
            document.querySelectorAll('.step-content').forEach(el => {
                el.classList.remove('active');
            });

            // æ˜¾ç¤ºå½“å‰æ­¥éª¤
            const stepElement = document.getElementById('step' + step);
            if (stepElement) {
                stepElement.classList.add('active');
                debugLog('æˆåŠŸæ˜¾ç¤ºæ­¥éª¤ ' + step);
                currentStep = step;
            } else {
                debugLog('é”™è¯¯ï¼šæœªæ‰¾åˆ°æ­¥éª¤ ' + step + ' çš„å…ƒç´ ');
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                goToStep(currentStep - 1);
            }
        }

        function testStep3() {
            goToStep(3);
        }

        function showLoading(text = 'å¤„ç†ä¸­...') {
            debugLog('æ˜¾ç¤ºåŠ è½½æç¤º: ' + text);
            const overlay = document.getElementById('loadingOverlay');
            const loadingText = document.getElementById('loadingText');
            if (overlay && loadingText) {
                loadingText.textContent = text;
                overlay.classList.remove('hidden');
            } else {
                debugLog('é”™è¯¯ï¼šæœªæ‰¾åˆ°åŠ è½½æç¤ºå…ƒç´ ');
            }
        }

        function hideLoading() {
            debugLog('éšè—åŠ è½½æç¤º');
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.classList.add('hidden');
            } else {
                debugLog('é”™è¯¯ï¼šæœªæ‰¾åˆ°åŠ è½½æç¤ºå…ƒç´ ');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            debugLog('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–...');
            initializeApp();
        });

        // æ·»åŠ å…¨å±€é”™è¯¯å¤„ç†
        window.addEventListener('error', function(e) {
            debugLog('å…¨å±€é”™è¯¯: ' + e.message + ' at ' + e.filename + ':' + e.lineno);
        });
    </script>
</body>
</html>