<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¼èˆªé—®é¢˜è¯Šæ–­</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>ğŸ”§ å¯¼èˆªé—®é¢˜è¯Šæ–­</h1>
            <p>æ£€æŸ¥JavaScriptå‡½æ•°æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
        </header>

        <main class="main-content">
            <div class="step-content active">
                <h2>ğŸ§ª åŠŸèƒ½æµ‹è¯•</h2>

                <div class="form-group">
                    <label>æµ‹è¯•åœºæ™¯:</label>
                    <select id="testTheme">
                        <option value="å…¬äº¤ç«™">å…¬äº¤ç«™</option>
                        <option value="åšç‰©é¦†">åšç‰©é¦†</option>
                        <option value="è¶…å¸‚">è¶…å¸‚</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>æµ‹è¯•æ ‡é¢˜:</label>
                    <input type="text" id="testTitle" value="æµ‹è¯•æ ‡é¢˜">
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="testStepNavigation()">æµ‹è¯•æ­¥éª¤è·³è½¬</button>
                    <button class="btn btn-secondary" onclick="testVocabularyGeneration()">æµ‹è¯•è¯æ±‡ç”Ÿæˆ</button>
                    <button class="btn btn-info" onclick="testFunctionsExistence()">æµ‹è¯•å‡½æ•°å­˜åœ¨æ€§</button>
                </div>

                <div id="testResults" style="margin-top: 30px; display: none;">
                    <h3>ğŸ“‹ æµ‹è¯•ç»“æœ</h3>
                    <div id="resultsContainer"></div>
                </div>
            </div>

            <!-- æ­¥éª¤2 (éšè—) -->
            <div id="step2" class="step-content">
                <h2>ğŸ“š è¯æ±‡æ˜¾ç¤ºæµ‹è¯•</h2>
                <div id="vocabularyList">
                    <p>è¿™é‡Œæ˜¯æ­¥éª¤2çš„å†…å®¹</p>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="goBackToStep1()">è¿”å›æ­¥éª¤1</button>
                </div>
            </div>
        </main>

        <!-- æ­¥éª¤æŒ‡ç¤ºå™¨ -->
        <div class="steps-indicator">
            <div class="step active" data-step="1">
                <span class="step-number">1</span>
                <span class="step-title">æµ‹è¯•</span>
            </div>
            <div class="step" data-step="2">
                <span class="step-number">2</span>
                <span class="step-title">è¯æ±‡</span>
            </div>
        </div>
    </div>

    <script src="vocabulary.js"></script>
    <script>
        let userData = {};
        let vocabulary = [];

        // æµ‹è¯•å‡½æ•°å­˜åœ¨æ€§
        function testFunctionsExistence() {
            const results = [];

            results.push({
                test: 'getVocabularyå‡½æ•°å­˜åœ¨',
                status: typeof getVocabulary !== 'undefined',
                detail: typeof getVocabulary !== 'undefined' ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'
            });

            results.push({
                test: 'generateTagTextå‡½æ•°å­˜åœ¨',
                status: typeof generateTagText !== 'undefined',
                detail: typeof generateTagText !== 'undefined' ? 'âœ… å­˜åœ¨' : 'âŒ ä¸å­˜åœ¨'
            });

            results.push({
                test: 'document.getElementByIdå¯ç”¨',
                status: typeof document.getElementById === 'function',
                detail: 'âœ… å¯ç”¨'
            });

            results.push({
                test: 'querySelectorå¯ç”¨',
                status: typeof document.querySelector === 'function',
                detail: 'âœ… å¯ç”¨'
            });

            displayResults('å‡½æ•°å­˜åœ¨æ€§æµ‹è¯•', results);
        }

        // æµ‹è¯•æ­¥éª¤è·³è½¬
        function testStepNavigation() {
            const results = [];

            try {
                // æµ‹è¯•å…ƒç´ æŸ¥æ‰¾
                const step1 = document.getElementById('step1');
                const step2 = document.getElementById('step2');

                results.push({
                    test: 'æ‰¾åˆ°æ­¥éª¤1å…ƒç´ ',
                    status: !!step1,
                    detail: !!step1 ? 'âœ… æ‰¾åˆ°' : 'âŒ æœªæ‰¾åˆ°'
                });

                results.push({
                    test: 'æ‰¾åˆ°æ­¥éª¤2å…ƒç´ ',
                    status: !!step2,
                    detail: !!step2 ? 'âœ… æ‰¾åˆ°' : 'âŒ æœªæ‰¾åˆ°'
                });

                if (step1 && step2) {
                    // æµ‹è¯•è·³è½¬åˆ°æ­¥éª¤2
                    goToStep(2);
                    results.push({
                        test: 'è·³è½¬åˆ°æ­¥éª¤2',
                        status: step2.classList.contains('active'),
                        detail: step2.classList.contains('active') ? 'âœ… æˆåŠŸ' : 'âŒ å¤±è´¥'
                    });

                    setTimeout(() => {
                        // æµ‹è¯•è¿”å›æ­¥éª¤1
                        goToStep(1);
                        results.push({
                            test: 'è¿”å›æ­¥éª¤1',
                            status: step1.classList.contains('active'),
                            detail: step1.classList.contains('active') ? 'âœ… æˆåŠŸ' : 'âŒ å¤±è´¥'
                        });
                        displayResults('æ­¥éª¤è·³è½¬æµ‹è¯•', results);
                    }, 1000);
                }

            } catch (error) {
                results.push({
                    test: 'è·³è½¬è¿‡ç¨‹ä¸­å‡ºé”™',
                    status: false,
                    detail: 'âŒ é”™è¯¯: ' + error.message
                });
                displayResults('æ­¥éª¤è·³è½¬æµ‹è¯•', results);
            }
        }

        // æµ‹è¯•è¯æ±‡ç”Ÿæˆ
        function testVocabularyGeneration() {
            const results = [];

            try {
                // è®¾ç½®æµ‹è¯•æ•°æ®
                userData = {
                    theme: document.getElementById('testTheme').value,
                    title: document.getElementById('testTitle').value,
                    languages: ['chinese', 'english'],
                    difficulty: 'level1'
                };

                results.push({
                    test: 'è®¾ç½®æµ‹è¯•æ•°æ®',
                    status: true,
                    detail: `ä¸»é¢˜: ${userData.theme}, æ ‡é¢˜: ${userData.title}`
                });

                // æµ‹è¯•è¯æ±‡ç”Ÿæˆ
                vocabulary = getVocabulary(userData.theme, userData.difficulty);
                results.push({
                    test: 'è¯æ±‡ç”ŸæˆæˆåŠŸ',
                    status: Array.isArray(vocabulary) && vocabulary.length > 0,
                    detail: `ç”Ÿæˆäº† ${vocabulary.length} ä¸ªè¯æ±‡`
                });

                // æµ‹è¯•æ ‡ç­¾ç”Ÿæˆ
                const tags = generateTagText(vocabulary, userData.languages);
                results.push({
                    test: 'æ ‡ç­¾ç”ŸæˆæˆåŠŸ',
                    status: Array.isArray(tags) && tags.length > 0,
                    detail: `ç”Ÿæˆäº† ${tags.length} ä¸ªæ ‡ç­¾`
                });

                // æµ‹è¯•è·³è½¬
                goToStep(2);
                results.push({
                    test: 'è¯æ±‡ç”Ÿæˆåè·³è½¬æˆåŠŸ',
                    status: document.getElementById('step2').classList.contains('active'),
                    detail: 'âœ… æˆåŠŸè·³è½¬åˆ°æ­¥éª¤2'
                });

                // æ˜¾ç¤ºè¯æ±‡
                const vocabularyHtml = vocabulary.slice(0, 5).map((item, index) =>
                    `<div style="margin: 5px 0; padding: 8px; background: #f0f0f0; border-radius: 4px;">
                        <strong>${index + 1}. ${item.chinese}</strong> - ${item.english}
                    </div>`
                ).join('');

                document.getElementById('vocabularyList').innerHTML = vocabularyHtml;

                displayResults('è¯æ±‡ç”Ÿæˆæµ‹è¯•', results);

            } catch (error) {
                results.push({
                    test: 'è¯æ±‡ç”Ÿæˆè¿‡ç¨‹ä¸­å‡ºé”™',
                    status: false,
                    detail: 'âŒ é”™è¯¯: ' + error.message
                });
                displayResults('è¯æ±‡ç”Ÿæˆæµ‹è¯•', results);
            }
        }

        // æ˜¾ç¤ºæµ‹è¯•ç»“æœ
        function displayResults(testName, results) {
            document.getElementById('testResults').style.display = 'block';

            const html = `
                <div class="result-section">
                    <h4>${testName}</h4>
                    ${results.map(result => `
                        <div style="margin: 10px 0; padding: 10px; background: ${result.status ? '#e8f5e8' : '#ffebee'}; border-radius: 4px;">
                            <strong>${result.test}:</strong> ${result.detail}
                        </div>
                    `).join('')}
                </div>
            `;

            document.getElementById('resultsContainer').innerHTML = html;
        }

        // è·³è½¬åˆ°æŒ‡å®šæ­¥éª¤
        function goToStep(step) {
            console.log(`å°è¯•è·³è½¬åˆ°æ­¥éª¤ ${step}`);

            // éšè—æ‰€æœ‰æ­¥éª¤
            document.querySelectorAll('.step-content').forEach(el => {
                el.classList.remove('active');
            });

            // æ˜¾ç¤ºå½“å‰æ­¥éª¤
            const stepElement = document.getElementById(`step${step}`);
            if (stepElement) {
                stepElement.classList.add('active');
                console.log(`æˆåŠŸæ˜¾ç¤ºæ­¥éª¤ ${step}`);
            } else {
                console.error(`æœªæ‰¾åˆ°æ­¥éª¤ ${step} çš„å…ƒç´ `);
            }

            // æ›´æ–°æ­¥éª¤æŒ‡ç¤ºå™¨
            document.querySelectorAll('.step').forEach(el => {
                el.classList.remove('active');
                el.classList.remove('completed');
            });

            for (let i = 1; i <= step; i++) {
                const stepIndicator = document.querySelector(`.step[data-step="${i}"]`);
                if (stepIndicator) {
                    if (i < step) {
                        stepIndicator.classList.add('completed');
                    } else if (i === step) {
                        stepIndicator.classList.add('active');
                    }
                }
            }
        }

        // è¿”å›æ­¥éª¤1
        function goBackToStep1() {
            goToStep(1);
        }
    </script>
</body>
</html>